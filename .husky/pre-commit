#!/usr/bin/env sh
. "$(dirname -- "$0")/_/husky.sh"

# –ó–∞–ø—É—Å–∫–∞–µ–º lint-staged –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏ –∏–∑–º–µ–Ω–µ–Ω–Ω—ã—Ö —Ñ–∞–π–ª–æ–≤
npx lint-staged

# –ï—Å–ª–∏ –µ—Å—Ç—å –∏–∑–º–µ–Ω–µ–Ω–∏—è –≤ —Ç–µ—Å—Ç–∞—Ö –∏–ª–∏ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–∞—Ö - –∑–∞–ø—É—Å–∫–∞–µ–º –≤—Å–µ —Ç–µ—Å—Ç—ã –∑–∞—â–∏—Ç—ã
if git diff --cached --name-only | grep -E "(stores|components/battle/enhanced)"; then
  echo "üß™ –ó–∞–ø—É—Å–∫ —Ç–µ—Å—Ç–æ–≤ –∑–∞—â–∏—Ç—ã –æ—Ç React Error #185..."
  npm run test -- --run --reporter=verbose
  
  if [ $? -ne 0 ]; then
    echo "‚ùå –¢–µ—Å—Ç—ã –Ω–µ –ø—Ä–æ—à–ª–∏! –ö–æ–º–º–∏—Ç –æ—Ç–º–µ–Ω–µ–Ω."
    exit 1
  fi
  echo "‚úÖ –í—Å–µ —Ç–µ—Å—Ç—ã –ø—Ä–æ—à–ª–∏ —É—Å–ø–µ—à–Ω–æ!"
fi
