# üê∫ Husky Pre-commit Hook Setup

## –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –∑–∞—â–∏—Ç–∞ –æ—Ç React Error #185

Husky –Ω–∞—Å—Ç—Ä–æ–µ–Ω –¥–ª—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–≥–æ –∑–∞–ø—É—Å–∫–∞ —Ç–µ—Å—Ç–æ–≤ –ø–µ—Ä–µ–¥ –∫–∞–∂–¥—ã–º –∫–æ–º–º–∏—Ç–æ–º, –ø—Ä–µ–¥–æ—Ç–≤—Ä–∞—â–∞—è –ø–æ–ø–∞–¥–∞–Ω–∏–µ –∫–æ–¥–∞ —Å –Ω–∞—Ä—É—à–µ–Ω–∏—è–º–∏ Rules of Hooks –≤ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π.

## –ß—Ç–æ –ø—Ä–æ–≤–µ—Ä—è–µ—Ç—Å—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏?

### 1. ESLint –ø—Ä–æ–≤–µ—Ä–∫–∞ –∏–∑–º–µ–Ω–µ–Ω–Ω—ã—Ö —Ñ–∞–π–ª–æ–≤
- –í—Å–µ `.ts` –∏ `.tsx` —Ñ–∞–π–ª—ã –ø—Ä–æ—Ö–æ–¥—è—Ç —á–µ—Ä–µ–∑ ESLint
- –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –ø—Ä–æ—Å—Ç—ã—Ö –æ—à–∏–±–æ–∫ (`--fix`)
- –ë–ª–æ–∫–∏—Ä—É–µ—Ç –∫–æ–º–º–∏—Ç –ø—Ä–∏ –æ–±–Ω–∞—Ä—É–∂–µ–Ω–∏–∏ –Ω–∞—Ä—É—à–µ–Ω–∏–π Rules of Hooks

### 2. –¢–µ—Å—Ç—ã —Å–≤—è–∑–∞–Ω–Ω—ã—Ö –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–æ–≤
- –ü—Ä–∏ –∏–∑–º–µ–Ω–µ–Ω–∏–∏ —Ñ–∞–π–ª–æ–≤ –∑–∞–ø—É—Å–∫–∞—é—Ç—Å—è —Ç–µ—Å—Ç—ã, —Å–≤—è–∑–∞–Ω–Ω—ã–µ —Å —ç—Ç–∏–º–∏ —Ñ–∞–π–ª–∞–º–∏
- –ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è `vitest related` –¥–ª—è –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏

### 3. –ü–æ–ª–Ω—ã–π –ø—Ä–æ–≥–æ–Ω —Ç–µ—Å—Ç–æ–≤ –∑–∞—â–∏—Ç—ã
- –ï—Å–ª–∏ –∏–∑–º–µ–Ω–µ–Ω—ã —Ñ–∞–π–ª—ã –≤ `stores/` –∏–ª–∏ `components/battle/enhanced/`
- –ó–∞–ø—É—Å–∫–∞—é—Ç—Å—è –≤—Å–µ —Ç–µ—Å—Ç—ã –∑–∞—â–∏—Ç—ã –æ—Ç React Error #185
- –ë–ª–æ–∫–∏—Ä—É–µ—Ç –∫–æ–º–º–∏—Ç –ø—Ä–∏ –ø–∞–¥–µ–Ω–∏–∏ –ª—é–±–æ–≥–æ —Ç–µ—Å—Ç–∞

## –£—Å—Ç–∞–Ω–æ–≤–∫–∞

### –ü–µ—Ä–≤–æ–Ω–∞—á–∞–ª—å–Ω–∞—è —É—Å—Ç–∞–Ω–æ–≤–∫–∞ Husky

```bash
# –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π (—É–∂–µ –≤—ã–ø–æ–ª–Ω–µ–Ω–æ)
npm install

# –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è Husky
npx husky init

# –ò–ª–∏ –µ—Å–ª–∏ —É –≤–∞—Å —É–∂–µ –µ—Å—Ç—å .husky –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏—è
chmod +x .husky/pre-commit
```

### –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ä–∞–±–æ—Ç—ã

```bash
# –ü–æ–ø—Ä–æ–±—É–π—Ç–µ —Å–¥–µ–ª–∞—Ç—å –∫–æ–º–º–∏—Ç —Å —Ç–µ—Å—Ç–æ–≤—ã–º–∏ –∏–∑–º–µ–Ω–µ–Ω–∏—è–º–∏
git add .
git commit -m "test: –ø—Ä–æ–≤–µ—Ä–∫–∞ husky hook"

# –í—ã –¥–æ–ª–∂–Ω—ã —É–≤–∏–¥–µ—Ç—å:
# üß™ –ó–∞–ø—É—Å–∫ —Ç–µ—Å—Ç–æ–≤ –∑–∞—â–∏—Ç—ã –æ—Ç React Error #185...
# ‚úÖ –í—Å–µ —Ç–µ—Å—Ç—ã –ø—Ä–æ—à–ª–∏ —É—Å–ø–µ—à–Ω–æ!
```

## –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è

### `.lintstagedrc.json`

```json
{
  "*.{ts,tsx}": [
    "eslint --fix",
    "vitest related --run --reporter=verbose"
  ],
  "src/**/__tests__/**/*.{ts,tsx}": [
    "vitest --run --reporter=verbose"
  ]
}
```

### `.husky/pre-commit`

–•—É–∫ –≤—ã–ø–æ–ª–Ω—è–µ—Ç:
1. –ó–∞–ø—É—Å–∫ lint-staged –¥–ª—è –∏–∑–º–µ–Ω–µ–Ω–Ω—ã—Ö —Ñ–∞–π–ª–æ–≤
2. –ü—Ä–æ–≤–µ—Ä–∫—É –Ω–∞ –∏–∑–º–µ–Ω–µ–Ω–∏—è –≤ –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏—Ö –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏—è—Ö
3. –ü–æ–ª–Ω—ã–π –ø—Ä–æ–≥–æ–Ω —Ç–µ—Å—Ç–æ–≤ –∑–∞—â–∏—Ç—ã –ø—Ä–∏ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ—Å—Ç–∏

## –ß—Ç–æ –±–ª–æ–∫–∏—Ä—É–µ—Ç—Å—è?

### ‚ùå –ù–∞—Ä—É—à–µ–Ω–∏—è Rules of Hooks
```typescript
// ‚ùå –£—Å–ª–æ–≤–Ω—ã–π –≤—ã–∑–æ–≤ —Ö—É–∫–∞
if (condition) {
  useEffect(() => {}, []);
}
```

### ‚ùå –ù–µ—Å—Ç–∞–±–∏–ª—å–Ω—ã–µ —Å–µ–ª–µ–∫—Ç–æ—Ä—ã
```typescript
// ‚ùå –°–µ–ª–µ–∫—Ç–æ—Ä –±–µ–∑ –º–µ–º–æ–∏–∑–∞—Ü–∏–∏
export const useTokens = () => 
  useUnifiedBattleStore(state => state.tokens);
```

### ‚ùå –î–∏–Ω–∞–º–∏—á–µ—Å–∫–∏–µ –ø—É—Ç–∏ –≤ useGLTF
```typescript
// ‚ùå –î–∏–Ω–∞–º–∏—á–µ—Å–∫–∏–π –ø—É—Ç—å
const gltf = useGLTF(modelPath);
```

### ‚ùå State –º—É—Ç–∞—Ü–∏–∏ –≤ render —Ñ–∞–∑–µ
```typescript
// ‚ùå –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ state –≤ map()
tokens.map(token => {
  updateToken(token.id, { ... });
  return <Token />;
});
```

## –û–±—Ö–æ–¥ –ø—Ä–æ–≤–µ—Ä–æ–∫ (–ù–ï —Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è)

–ï—Å–ª–∏ –≤–∞–º –ê–ë–°–û–õ–Æ–¢–ù–û –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ —Å–¥–µ–ª–∞—Ç—å –∫–æ–º–º–∏—Ç –±–µ–∑ –ø—Ä–æ–≤–µ—Ä–æ–∫:

```bash
git commit -m "message" --no-verify
```

‚ö†Ô∏è **–ü–†–ï–î–£–ü–†–ï–ñ–î–ï–ù–ò–ï:** –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ —Ç–æ–ª—å–∫–æ –≤ –∫—Ä–∞–π–Ω–∏—Ö —Å–ª—É—á–∞—è—Ö! –≠—Ç–æ –º–æ–∂–µ—Ç –ø—Ä–∏–≤–µ—Å—Ç–∏ –∫ React Error #185 –≤ –ø—Ä–æ–¥–∞–∫—à–µ–Ω–µ.

## –û—Ç–ª–∞–¥–∫–∞

### –•—É–∫ –Ω–µ –∑–∞–ø—É—Å–∫–∞–µ—Ç—Å—è

```bash
# –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ø—Ä–∞–≤–∞ –¥–æ—Å—Ç—É–ø–∞
ls -la .husky/pre-commit

# –î–æ–ª–∂–Ω–æ –±—ã—Ç—å: -rwxr-xr-x
# –ï—Å–ª–∏ –Ω–µ—Ç, –∏—Å–ø—Ä–∞–≤—å—Ç–µ:
chmod +x .husky/pre-commit
```

### –¢–µ—Å—Ç—ã –ø–∞–¥–∞—é—Ç –ª–æ–∫–∞–ª—å–Ω–æ

```bash
# –ó–∞–ø—É—Å—Ç–∏—Ç–µ —Ç–µ—Å—Ç—ã –≤—Ä—É—á–Ω—É—é –¥–ª—è –æ—Ç–ª–∞–¥–∫–∏
npm run test

# –ó–∞–ø—É—Å—Ç–∏—Ç–µ —Å –ø–æ–¥—Ä–æ–±–Ω—ã–º –≤—ã–≤–æ–¥–æ–º
npm run test -- --reporter=verbose

# –ó–∞–ø—É—Å—Ç–∏—Ç–µ —Ç–æ–ª—å–∫–æ —Ç–µ—Å—Ç—ã –∑–∞—â–∏—Ç—ã
npm run test -- src/stores/__tests__/unifiedBattleStoreExports.test.ts
```

### –•—É–∫ —Ä–∞–±–æ—Ç–∞–µ—Ç —Å–ª–∏—à–∫–æ–º –¥–æ–ª–≥–æ

–ï—Å–ª–∏ –ø–æ–ª–Ω—ã–π –ø—Ä–æ–≥–æ–Ω —Ç–µ—Å—Ç–æ–≤ –∑–∞–Ω–∏–º–∞–µ—Ç –º–Ω–æ–≥–æ –≤—Ä–µ–º–µ–Ω–∏, –º–æ–∂–Ω–æ –æ–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞—Ç—å:

1. **–û–≥—Ä–∞–Ω–∏—á–∏—Ç—å –∑–∞–ø—É—Å–∫ –ø–æ–ª–Ω—ã—Ö —Ç–µ—Å—Ç–æ–≤**
   - –†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞—Ç—å `.husky/pre-commit`
   - –£–±—Ä–∞—Ç—å –ø–æ–ª–Ω—ã–π –ø—Ä–æ–≥–æ–Ω —Ç–µ—Å—Ç–æ–≤
   - –û—Å—Ç–∞–≤–∏—Ç—å —Ç–æ–ª—å–∫–æ `lint-staged`

2. **–ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å CI/CD**
   - –ü–æ–ª–Ω—ã–π –ø—Ä–æ–≥–æ–Ω —Ç–µ—Å—Ç–æ–≤ –≤ GitHub Actions
   - –õ–æ–∫–∞–ª—å–Ω–æ —Ç–æ–ª—å–∫–æ –±—ã—Å—Ç—Ä—ã–µ –ø—Ä–æ–≤–µ—Ä–∫–∏

## –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å CI/CD

–°–º. –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—é –ø–æ –Ω–∞—Å—Ç—Ä–æ–π–∫–µ GitHub Actions –≤ `TESTING.md`

## –ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞

‚úÖ **–ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –∑–∞—â–∏—Ç–∞** - –Ω–µ–≤–æ–∑–º–æ–∂–Ω–æ –∑–∞–∫–æ–º–º–∏—Ç–∏—Ç—å –∫–æ–¥ —Å –Ω–∞—Ä—É—à–µ–Ω–∏—è–º–∏  
‚úÖ **–ë—ã—Å—Ç—Ä–∞—è –æ–±—Ä–∞—Ç–Ω–∞—è —Å–≤—è–∑—å** - –æ—à–∏–±–∫–∏ –æ–±–Ω–∞—Ä—É–∂–∏–≤–∞—é—Ç—Å—è —Å—Ä–∞–∑—É, –∞ –Ω–µ –≤ CI  
‚úÖ **–ú–µ–Ω—å—à–µ —Ä–µ–≤—å—é** - –±–∞–∑–æ–≤—ã–µ –ø—Ä–æ–±–ª–µ–º—ã –æ—Ç–ª–∞–≤–ª–∏–≤–∞—é—Ç—Å—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏  
‚úÖ **–°—Ç–∞–±–∏–ª—å–Ω—ã–π main branch** - —Ç–æ–ª—å–∫–æ –ø—Ä–æ–≤–µ—Ä–µ–Ω–Ω—ã–π –∫–æ–¥ –ø–æ–ø–∞–¥–∞–µ—Ç –≤ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π  
‚úÖ **–ü—Ä–µ–¥–æ—Ç–≤—Ä–∞—â–µ–Ω–∏–µ —Ä–µ–≥—Ä–µ—Å—Å–∏–π** - React Error #185 –±–æ–ª—å—à–µ –Ω–µ –≤–µ—Ä–Ω–µ—Ç—Å—è  

## –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –∑–∞—â–∏—Ç—ã (–≤—Å–µ 3 —É—Ä–æ–≤–Ω—è)

1. **üîß –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–Ω–∞—è –∑–∞—â–∏—Ç–∞** - ModelLoader.tsx —Å —Ñ–∏–∫—Å–∏—Ä–æ–≤–∞–Ω–Ω—ã–º–∏ –ø—É—Ç—è–º–∏
2. **üìù –°—Ç–∞—Ç–∏—á–µ—Å–∫–∏–π –∞–Ω–∞–ª–∏–∑** - ESLint —Å rules-of-hooks
3. **üß™ Runtime –≤–∞–ª–∏–¥–∞—Ü–∏—è** - hooksValidator.ts + unit —Ç–µ—Å—Ç—ã
4. **üê∫ Pre-commit hook** - –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞ –ø–µ—Ä–µ–¥ –∫–æ–º–º–∏—Ç–æ–º ‚ú® –ù–û–í–û–ï

## –°–≤—è–∑–∞–Ω–Ω–∞—è –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è

- `TESTING.md` - –ø–æ–¥—Ä–æ–±–Ω–∞—è –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è –ø–æ —Ç–µ—Å—Ç–∞–º
- `README-TESTS.md` - –±—ã—Å—Ç—Ä—ã–π —Å—Ç–∞—Ä—Ç —Å —Ç–µ—Å—Ç–∞–º–∏
- `HOOKS_PROTECTION.md` - –ø–æ–ª–Ω–æ–µ –æ–ø–∏—Å–∞–Ω–∏–µ –∑–∞—â–∏—Ç—ã –æ—Ç React Error #185
- `.eslintrc.json` - –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è ESLint

---

**–¢–µ–ø–µ—Ä—å –≤–∞—à —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π –∑–∞—â–∏—â–µ–Ω –Ω–∞ –≤—Å–µ—Ö —É—Ä–æ–≤–Ω—è—Ö! üõ°Ô∏è**
